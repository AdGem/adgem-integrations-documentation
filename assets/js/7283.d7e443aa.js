"use strict";(self.webpackChunkadgem_integrations_documentation=self.webpackChunkadgem_integrations_documentation||[]).push([[7283],{67283:(e,n,o)=>{o.d(n,{createClient:()=>f});const t=Object.prototype.hasOwnProperty;function r(e){return"object"==typeof e&&null!==e}function i(e,n){return t.call(e,n)}function a(e,n){return t.call(e,n)&&r(e[n])}function s(e,n){return t.call(e,n)&&"string"==typeof e[n]}function c(e,n){return e.length<124?e:n}const l="graphql-transport-ws";var d,u;function p(e){if(r(e)){if(!s(e,"type"))return!1;switch(e.type){case u.ConnectionInit:case u.ConnectionAck:case u.Ping:case u.Pong:return!i(e,"payload")||void 0===e.payload||r(e.payload);case u.Subscribe:return s(e,"id")&&a(e,"payload")&&(!i(e.payload,"operationName")||void 0===e.payload.operationName||null===e.payload.operationName||"string"==typeof e.payload.operationName)&&s(e.payload,"query")&&(!i(e.payload,"variables")||void 0===e.payload.variables||null===e.payload.variables||a(e.payload,"variables"))&&(!i(e.payload,"extensions")||void 0===e.payload.extensions||null===e.payload.extensions||a(e.payload,"extensions"));case u.Next:return s(e,"id")&&a(e,"payload");case u.Error:return s(e,"id")&&(n=e.payload,Array.isArray(n)&&n.length>0&&n.every((e=>"message"in e)));case u.Complete:return s(e,"id");default:return!1}}var n;return!1}function y(e,n){if(!p(e))throw new Error("Cannot stringify invalid message");return JSON.stringify(e,n)}!function(e){e[e.InternalServerError=4500]="InternalServerError",e[e.InternalClientError=4005]="InternalClientError",e[e.BadRequest=4400]="BadRequest",e[e.BadResponse=4004]="BadResponse",e[e.Unauthorized=4401]="Unauthorized",e[e.Forbidden=4403]="Forbidden",e[e.SubprotocolNotAcceptable=4406]="SubprotocolNotAcceptable",e[e.ConnectionInitialisationTimeout=4408]="ConnectionInitialisationTimeout",e[e.ConnectionAcknowledgementTimeout=4504]="ConnectionAcknowledgementTimeout",e[e.SubscriberAlreadyExists=4409]="SubscriberAlreadyExists",e[e.TooManyInitialisationRequests=4429]="TooManyInitialisationRequests"}(d||(d={})),function(e){e.ConnectionInit="connection_init",e.ConnectionAck="connection_ack",e.Ping="ping",e.Pong="pong",e.Subscribe="subscribe",e.Next="next",e.Error="error",e.Complete="complete"}(u||(u={}));var m=o(96763);function f(e){const{url:n,connectionParams:o,lazy:t=!0,onNonLazyError:r=m.error,lazyCloseTimeout:i=0,keepAlive:a=0,disablePong:s,connectionAckWaitTimeout:f=0,retryAttempts:b=5,retryWait:w=async function(e){let n=1e3;for(let o=0;o<e;o++)n*=2;await new Promise((e=>setTimeout(e,n+Math.floor(2700*Math.random()+300))))},isFatalConnectionProblem:x=e=>!g(e),on:v,webSocketImpl:h,generateID:C=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(e=>{const n=16*Math.random()|0;return("x"==e?n:3&n|8).toString(16)}))},jsonMessageReplacer:S,jsonMessageReviver:E}=e;let k;if(h){if(!("function"==typeof(I=h)&&"constructor"in I&&"CLOSED"in I&&"CLOSING"in I&&"CONNECTING"in I&&"OPEN"in I))throw new Error("Invalid WebSocket implementation provided");k=h}else"undefined"!=typeof WebSocket?k=WebSocket:"undefined"!=typeof global?k=global.WebSocket||global.MozWebSocket:"undefined"!=typeof window&&(k=window.WebSocket||window.MozWebSocket);var I;if(!k)throw new Error("WebSocket implementation missing; on Node you can `import WebSocket from 'ws';` and pass `webSocketImpl: WebSocket` to `createClient`");const N=k,P=(()=>{const e=(()=>{const e={};return{on:(n,o)=>(e[n]=o,()=>{delete e[n]}),emit(n){var o;"id"in n&&(null===(o=e[n.id])||void 0===o||o.call(e,n))}}})(),n={connecting:(null==v?void 0:v.connecting)?[v.connecting]:[],opened:(null==v?void 0:v.opened)?[v.opened]:[],connected:(null==v?void 0:v.connected)?[v.connected]:[],ping:(null==v?void 0:v.ping)?[v.ping]:[],pong:(null==v?void 0:v.pong)?[v.pong]:[],message:(null==v?void 0:v.message)?[e.emit,v.message]:[e.emit],closed:(null==v?void 0:v.closed)?[v.closed]:[],error:(null==v?void 0:v.error)?[v.error]:[]};return{onMessage:e.on,on(e,o){const t=n[e];return t.push(o),()=>{t.splice(t.indexOf(o),1)}},emit(e,...o){for(const t of[...n[e]])t(...o)}}})();function T(e){const n=[P.on("error",(o=>{n.forEach((e=>e())),e(o)})),P.on("closed",(o=>{n.forEach((e=>e())),e(o)}))]}let A,M=0,O=!1,R=0,W=!1;async function q(){const[e,t]=await(null!=A?A:A=new Promise(((e,t)=>(async()=>{if(O){if(await w(R),!M)return A=void 0,t({code:1e3,reason:"All Subscriptions Gone"});R++}P.emit("connecting");const r=new N("function"==typeof n?await n():n,l);let i,m;function g(){isFinite(a)&&a>0&&(clearTimeout(m),m=setTimeout((()=>{r.readyState===N.OPEN&&(r.send(y({type:u.Ping})),P.emit("ping",!1,void 0))}),a))}T((e=>{A=void 0,clearTimeout(i),clearTimeout(m),t(e)})),r.onerror=e=>P.emit("error",e),r.onclose=e=>P.emit("closed",e),r.onopen=async()=>{try{P.emit("opened",r);const e="function"==typeof o?await o():o;r.send(y(e?{type:u.ConnectionInit,payload:e}:{type:u.ConnectionInit},S)),isFinite(f)&&f>0&&(i=setTimeout((()=>{r.close(d.ConnectionAcknowledgementTimeout,"Connection acknowledgement timeout")}),f)),g()}catch(e){P.emit("error",e),r.close(d.InternalClientError,c(e instanceof Error?e.message:new Error(e).message,"Internal client error"))}};let b=!1;r.onmessage=({data:n})=>{try{const o=function(e,n){if(p(e))return e;if("string"!=typeof e)throw new Error("Message not parsable");const o=JSON.parse(e,n);if(!p(o))throw new Error("Invalid message");return o}(n,E);if(P.emit("message",o),"ping"===o.type||"pong"===o.type)return P.emit(o.type,!0,o.payload),void("pong"===o.type?g():s||(r.send(y(o.payload?{type:u.Pong,payload:o.payload}:{type:u.Pong})),P.emit("pong",!1,o.payload)));if(b)return;if(o.type!==u.ConnectionAck)throw new Error(`First message cannot be of type ${o.type}`);clearTimeout(i),b=!0,P.emit("connected",r,o.payload),O=!1,R=0,e([r,new Promise(((e,n)=>T(n)))])}catch(o){r.onmessage=null,P.emit("error",o),r.close(d.BadResponse,c(o instanceof Error?o.message:new Error(o).message,"Bad response"))}}})())));e.readyState===N.CLOSING&&await t;let r=()=>{};const m=new Promise((e=>r=e));return[e,r,Promise.race([m.then((()=>{if(!M){const n=()=>e.close(1e3,"Normal Closure");isFinite(i)&&i>0?setTimeout((()=>{M||e.readyState!==N.OPEN||n()}),i):n()}})),t])]}function z(e){if(g(e)&&(n=e.code,![1e3,1001,1006,1005,1012,1013,1013].includes(n)&&n>=1e3&&n<=1999||[d.InternalServerError,d.InternalClientError,d.BadRequest,d.BadResponse,d.Unauthorized,d.SubprotocolNotAcceptable,d.SubscriberAlreadyExists,d.TooManyInitialisationRequests].includes(e.code)))throw e;var n;if(W)return!1;if(g(e)&&1e3===e.code)return M>0;if(!b||R>=b)throw e;if(x(e))throw e;return O=!0}return t||(async()=>{for(M++;;)try{const[,,e]=await q();await e}catch(e){try{if(!z(e))return}catch(e){return null==r?void 0:r(e)}}})(),{on:P.on,subscribe(e,n){const o=C();let t=!1,r=!1,i=()=>{M--,t=!0};return(async()=>{for(M++;;)try{const[a,s,c]=await q();if(t)return s();const l=P.onMessage(o,(e=>{switch(e.type){case u.Next:return void n.next(e.payload);case u.Error:return r=!0,t=!0,n.error(e.payload),void i();case u.Complete:return t=!0,void i()}}));return a.send(y({id:o,type:u.Subscribe,payload:e},S)),i=()=>{t||a.readyState!==N.OPEN||a.send(y({id:o,type:u.Complete},S)),M--,t=!0,s()},void await c.finally(l)}catch(a){if(!z(a))return}})().then((()=>{r||n.complete()})).catch((e=>{n.error(e)})),()=>{t||i()}},async dispose(){if(W=!0,A){const[e]=await A;e.close(1e3,"Normal Closure")}}}}function g(e){return r(e)&&"code"in e&&"reason"in e}}}]);