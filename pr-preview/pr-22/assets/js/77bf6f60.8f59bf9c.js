"use strict";(self.webpackChunkadgem_integrations_documentation=self.webpackChunkadgem_integrations_documentation||[]).push([[1163],{1135:(e,r,n)=>{n.r(r),n.d(r,{assets:()=>c,contentTitle:()=>l,default:()=>h,frontMatter:()=>o,metadata:()=>i,toc:()=>d});const i=JSON.parse('{"id":"getting-started/preflight-checks","title":"Pre-flight Checks","description":"Verify offer availability before redirecting users to improve user experience.","source":"@site/docs/getting-started/preflight-checks.mdx","sourceDirName":"getting-started","slug":"/getting-started/preflight-checks","permalink":"/adgem-integrations-documentation/pr-preview/pr-22/docs/getting-started/preflight-checks","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":4,"frontMatter":{"sidebar_position":4,"title":"Pre-flight Checks","description":"Verify offer availability before redirecting users to improve user experience."},"sidebar":"mainSidebar","previous":{"title":"App Property Setup","permalink":"/adgem-integrations-documentation/pr-preview/pr-22/docs/getting-started/app-property-setup"},"next":{"title":"Offer API (REST)","permalink":"/adgem-integrations-documentation/pr-preview/pr-22/docs/integrations/offer-api"}}');var t=n(74848),s=n(28453);const o={sidebar_position:4,title:"Pre-flight Checks",description:"Verify offer availability before redirecting users to improve user experience."},l="Pre-flight Checks",c={},d=[{value:"Overview",id:"overview",level:2},{value:"How It Works",id:"how-it-works",level:2},{value:"HTTP Status Codes",id:"http-status-codes",level:2},{value:"Implementation",id:"implementation",level:2},{value:"Basic Flow",id:"basic-flow",level:3},{value:"Code Example",id:"code-example",level:3},{value:"Examples",id:"examples",level:2},{value:"Successful Scenario",id:"successful-scenario",level:3},{value:"Error Scenarios",id:"error-scenarios",level:3},{value:"Additional Information",id:"additional-information",level:2},{value:"Resources",id:"resources",level:2}];function a(e){const r={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,s.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(r.header,{children:(0,t.jsx)(r.h1,{id:"pre-flight-checks",children:"Pre-flight Checks"})}),"\n",(0,t.jsx)(r.p,{children:(0,t.jsx)(r.img,{src:"https://img.shields.io/badge/Status-Beta-yellow",alt:"Beta"})}),"\n",(0,t.jsx)(r.admonition,{title:"Joining the Beta",type:"info",children:(0,t.jsx)(r.p,{children:"Pre-flight checks are currently in beta. To join the beta program, please contact your Publisher Support Advocate."})}),"\n",(0,t.jsx)(r.h2,{id:"overview",children:"Overview"}),"\n",(0,t.jsxs)(r.p,{children:["AdGem has implemented a pre-flight check mechanism for offer links. This feature allows publishers to verify the status of an offer before redirecting users to the ",(0,t.jsx)(r.code,{children:"click_url"}),", improving user experience by avoiding dead or irrelevant links."]}),"\n",(0,t.jsx)(r.h2,{id:"how-it-works",children:"How It Works"}),"\n",(0,t.jsxs)(r.ol,{children:["\n",(0,t.jsxs)(r.li,{children:["Retrieve the ",(0,t.jsx)(r.code,{children:"click_url"})," from any of AdGem's APIs as usual"]}),"\n",(0,t.jsxs)(r.li,{children:["Before redirecting the user, send a ",(0,t.jsx)(r.code,{children:"HEAD"})," request to this ",(0,t.jsx)(r.code,{children:"click_url"})," from the user's device"]}),"\n",(0,t.jsx)(r.li,{children:"Our system returns a status code indicating whether it's safe to redirect the user"}),"\n",(0,t.jsx)(r.li,{children:"Based on the status code, decide whether to show the offer or take alternative actions"}),"\n"]}),"\n",(0,t.jsx)(r.admonition,{type:"note",children:(0,t.jsx)(r.p,{children:"AdGem only provides the status code. You can customize the message shown to users based on the response."})}),"\n",(0,t.jsx)(r.h2,{id:"http-status-codes",children:"HTTP Status Codes"}),"\n",(0,t.jsx)(r.p,{children:"The pre-flight check returns one of the following status codes:"}),"\n",(0,t.jsxs)(r.table,{children:[(0,t.jsx)(r.thead,{children:(0,t.jsxs)(r.tr,{children:[(0,t.jsx)(r.th,{children:"Status Code"}),(0,t.jsx)(r.th,{children:"Meaning"}),(0,t.jsx)(r.th,{children:"Action"})]})}),(0,t.jsxs)(r.tbody,{children:[(0,t.jsxs)(r.tr,{children:[(0,t.jsx)(r.td,{children:(0,t.jsx)(r.strong,{children:"200 OK"})}),(0,t.jsx)(r.td,{children:"Offer is active and user meets all targeting criteria"}),(0,t.jsx)(r.td,{children:"Safe to redirect the user"})]}),(0,t.jsxs)(r.tr,{children:[(0,t.jsx)(r.td,{children:(0,t.jsx)(r.strong,{children:"403 Forbidden"})}),(0,t.jsx)(r.td,{children:"User doesn't meet targeting criteria, or user/publisher is banned"}),(0,t.jsx)(r.td,{children:"Don't show this offer"})]}),(0,t.jsxs)(r.tr,{children:[(0,t.jsx)(r.td,{children:(0,t.jsx)(r.strong,{children:"404 Not Found"})}),(0,t.jsx)(r.td,{children:"Offer is not currently active or no longer exists"}),(0,t.jsx)(r.td,{children:"Remove offer from view"})]}),(0,t.jsxs)(r.tr,{children:[(0,t.jsx)(r.td,{children:(0,t.jsx)(r.strong,{children:"422 Unprocessable Entity"})}),(0,t.jsx)(r.td,{children:"The request is invalid"}),(0,t.jsx)(r.td,{children:"Check your request parameters"})]})]})]}),"\n",(0,t.jsx)(r.admonition,{title:"Store ID Eligibility",type:"tip",children:(0,t.jsxs)(r.p,{children:["A ",(0,t.jsx)(r.code,{children:"store_id"})," eligibility check is performed automatically during the pre-flight check. However, we recommend implementing your own ",(0,t.jsx)(r.code,{children:"store_id"})," filtering for more comprehensive control. You can collect the ",(0,t.jsx)(r.code,{children:"store_id"})," via ",(0,t.jsx)(r.a,{href:"/docs/webhooks",children:"Player Event Postbacks"}),"."]})}),"\n",(0,t.jsx)(r.h2,{id:"implementation",children:"Implementation"}),"\n",(0,t.jsx)(r.h3,{id:"basic-flow",children:"Basic Flow"}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-mermaid",children:"flowchart LR\n    A[Get click_url from API] --\x3e B[Send HEAD request]\n    B --\x3e C{Check status}\n    C --\x3e|200 OK| D[Redirect user to offer]\n    C --\x3e|403/404/422| E[Hide offer or fetch new one]\n"})}),"\n",(0,t.jsx)(r.h3,{id:"code-example",children:"Code Example"}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-javascript",children:"async function checkOfferAvailability(clickUrl) {\n  try {\n    const response = await fetch(clickUrl, {\n      method: 'HEAD'\n    });\n\n    switch (response.status) {\n      case 200:\n        // Safe to redirect\n        window.location.href = clickUrl;\n        break;\n      case 403:\n        console.log('User not eligible for this offer');\n        // Remove offer from view or fetch alternative\n        break;\n      case 404:\n        console.log('Offer no longer available');\n        // Remove offer from view\n        break;\n      case 422:\n        console.log('Invalid request');\n        // Check parameters\n        break;\n    }\n  } catch (error) {\n    console.error('Pre-flight check failed:', error);\n  }\n}\n"})}),"\n",(0,t.jsx)(r.admonition,{title:"Important",type:"warning",children:(0,t.jsxs)(r.p,{children:["The AdGem response to the ",(0,t.jsx)(r.code,{children:"HEAD"})," request will ",(0,t.jsx)(r.strong,{children:"never"})," have a body, only a status code!"]})}),"\n",(0,t.jsx)(r.h2,{id:"examples",children:"Examples"}),"\n",(0,t.jsx)(r.h3,{id:"successful-scenario",children:"Successful Scenario"}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{children:"Request: HEAD https://api.adgem.com/v1/click?appid=456&playerid=test035&platform=android&os_version=10.0.0&cid=4560\n\nResponse: HTTP 200 OK\nContent: (none)\n"})}),"\n",(0,t.jsxs)(r.p,{children:["A ",(0,t.jsx)(r.code,{children:"200"})," response means the offer is active and available. It's safe to redirect the player to the ",(0,t.jsx)(r.code,{children:"click_url"})," to begin the offer."]}),"\n",(0,t.jsx)(r.h3,{id:"error-scenarios",children:"Error Scenarios"}),"\n",(0,t.jsx)(r.p,{children:(0,t.jsx)(r.strong,{children:"Invalid Request (422)"})}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{children:"Request: HEAD https://api.adgem.com/v1/click?appid=example&playerid=test035&platform=android&os_version=10.0.0&cid=456\n\nResponse: HTTP 422 Unprocessable Entity\nContent: (none)\n"})}),"\n",(0,t.jsxs)(r.p,{children:["The ",(0,t.jsx)(r.code,{children:"appid"})," must be both an integer and a valid ID in the AdGem system."]}),"\n",(0,t.jsx)(r.p,{children:(0,t.jsx)(r.strong,{children:"Offer Not Found (404)"})}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{children:"Request: HEAD https://api.adgem.com/v1/click?appid=456&playerid=test035&platform=android&os_version=10.0.0&cid=456\n\nResponse: HTTP 404 Not Found\nContent: (none)\n"})}),"\n",(0,t.jsxs)(r.p,{children:["Even though ",(0,t.jsx)(r.code,{children:"appid"})," and ",(0,t.jsx)(r.code,{children:"cid"})," are valid, the offer is not currently active or no longer exists."]}),"\n",(0,t.jsx)(r.h2,{id:"additional-information",children:"Additional Information"}),"\n",(0,t.jsxs)(r.ul,{children:["\n",(0,t.jsxs)(r.li,{children:["The ",(0,t.jsx)(r.code,{children:"store_id"})," eligibility check is only performed for ",(0,t.jsx)(r.code,{children:"HEAD"})," requests and may not apply to all requests or all publishers"]}),"\n",(0,t.jsxs)(r.li,{children:["Publishers are encouraged to maintain their own ",(0,t.jsx)(r.code,{children:"store_id"})," filtering mechanisms for more comprehensive control over offer eligibility"]}),"\n"]}),"\n",(0,t.jsx)(r.h2,{id:"resources",children:"Resources"}),"\n",(0,t.jsxs)(r.ul,{children:["\n",(0,t.jsxs)(r.li,{children:[(0,t.jsx)(r.a,{href:"https://developer.mozilla.org/en-US/docs/Web/HTTP/Methods/HEAD",children:"HEAD - HTTP | MDN"})," - External documentation on HEAD requests"]}),"\n"]})]})}function h(e={}){const{wrapper:r}={...(0,s.R)(),...e.components};return r?(0,t.jsx)(r,{...e,children:(0,t.jsx)(a,{...e})}):a(e)}},28453:(e,r,n)=>{n.d(r,{R:()=>o,x:()=>l});var i=n(96540);const t={},s=i.createContext(t);function o(e){const r=i.useContext(s);return i.useMemo((function(){return"function"==typeof e?e(r):{...r,...e}}),[r,e])}function l(e){let r;return r=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:o(e.components),i.createElement(s.Provider,{value:r},e.children)}}}]);